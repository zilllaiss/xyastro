---
import type { GetStaticPaths, Page } from "astro";
import Single from "../../layouts/Single.astro"

export const getStaticPaths: GetStaticPaths = async ({paginate}) => {
    const posts = await Astro.glob('../posts/*.md')
    
    return paginate(posts, { pageSize: 7 });
}

interface Props {
    page: Page
}

const {page} = Astro.props;

---
<Single title="Blogs">
    <main class="main-pair">
        <article class="post-field">
            {page.data.map(p => { 
                return (
                    <div class="post">
                        <section class="post-date">{p.frontmatter.pubDate.toString().slice(0,10)}</section>
                        <section class="post-container">
                            <h3 class="post-title"><a href={p.url}>{p.frontmatter.title}</a></h3>
                            <div class="post-content">
                                {p.frontmatter.preamble}
                                <p class="readmore"><a href={p.url}>read post</a></p>
                            </div>
                        </section>
                    </div>    
                )
            })}
    
        </article>
        <aside class="bar-right">
            <h3>placholder</h3>
        </aside>
    </main>
    <div class="pagination">
        <!-- TODO: Fix the styling -->
        {page.currentPage - 1 > 0 && <p><a href={page.url.prev}>Prev</a></p>}
        {page.size >= 8 && <p>{page.currentPage}</p>}
        {page.currentPage !== page.lastPage && <p><a href={page.url.next}>Next</a></p>}
    </div>

</Single>

<style>
    .post-date {
        color: #fff;
    }
</style>